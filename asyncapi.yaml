asyncapi: 3.0.0
info:
  title: Process - Vård av husdjur Async API
  version: 1.0.0
  description: Initiering av flöde för hantering av Vård av husdjur

channels:
  vah.kundbehovsflode.requests:
    address: vah.kundbehovsflode.requests
    messages:
      VahKundbehovsflodeRequestMessage:
        $ref: "#/components/messages/VahKundbehovsflodeRequestMessage"

  vah.kundbehovsflode.responses:
    address: vah.kundbehovsflode.responses
    messages:
      VahKundbehovsflodeResponseMessage:
        $ref: "#/components/messages/VahKundbehovsflodeResponseMessage"

operations:
  VahKundbehovsflodeRequest:
    action: receive
    summary: Initiering av flöde för hantering av Vård av husdjur
    channel:
      $ref: "#/channels/vah.kundbehovsflode.requests"
    reply:
      address:
        description: Resultatet skickas tillbaka till originator.
        location: "$message.header#/replyTo"
      channel:
        $ref: "#/channels/vah.kundbehovsflode.responses"

components:
  schemas:
    VahKundbehovsflodeRequestMessageHeaders:
      type: object
      properties:
        replyTo:
          type: string
          description: Topic där response ska skickas
        correlationId:
          type: string
          format: uuid
          description: Unikt ID som kopplar ihop request & response

    VahKundbehovsflodeResponseMessageHeaders:
      type: object
      properties:
        correlationId:
          type: string
          description: Unikt ID som kopplar ihop request & response

    VahKundbehovsflodeRequestMessageData:
      type: object
      title: VahKundbehovsflodeRequestMessageData
      required:
        - kundbehovsflodeId
      properties:
        kundbehovsflodeId:
          type: string
          format: uuid
          description: Kundbehovsflöde id

    VahKundbehovsflodeResponseMessageData:
      type: object
      title: VahKundbehovsflodeResponseMessageData
      required:
        - kundbehovsflodeId
        - resultat
      properties:
        kundbehovsflodeId:
          type: string
          format: uuid
          description: Kundbehovsflöde id
        resultat:
          type: string

  messages:
    VahKundbehovsflodeRequestMessage:
      headers:
        $ref: "#/components/schemas/VahKundbehovsflodeRequestMessageHeaders"
      payload:
        title: VahKundbehovsflodeRequestMessagePayload
        allOf:
          - $ref: "kogito-cloudevent.yaml#/components/schemas/KogitoCloudEvent"
          - type: object
            title: VahKundbehovsflodeRequestMessageData
            required:
              - data
            properties:
              data:
                $ref: "#/components/schemas/VahKundbehovsflodeRequestMessageData"

    VahKundbehovsflodeResponseMessage:
      headers:
        $ref: "#/components/schemas/VahKundbehovsflodeResponseMessageHeaders"
      payload:
        title: VahKundbehovsflodeResponseMessagePayload
        allOf:
          - $ref: "kogito-cloudevent.yaml#/components/schemas/KogitoCloudEvent"
          - type: object
            title: VahKundbehovsflodeResponseMessageData
            required:
              - data
            properties:
              data:
                $ref: "#/components/schemas/VahKundbehovsflodeResponseMessageData"
